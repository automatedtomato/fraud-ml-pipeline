# Fraud ML Pipeline

A machine learning pipeline implementation project specialized for fraud detection. This project aims to learn and practice MLOps workflows using PostgreSQL + MLflow + FastAPI.

## Project Overview

Building a practical fraud detection system using simulated credit card transaction data generated by the "Sparkov" engine.

### Key Features
- **Feature Engineering**: Time-series and user behavior pattern analysis
- **Machine Learning**: Comparison of XGBoost, H2O AutoML, and PyTorch transfer learning
- **Evaluation**: Performance assessment using practical metrics like Precision@K
- **API**: FastAPI-based fraud scoring service
- **MLOps**: Experiment management and model versioning with MLflow

## Tech Stack

- **Backend**: Python, FastAPI, SQLAlchemy, psycopg2
- **Database**: PostgreSQL
- **ML**: PyTorch, XGBoost, H2O AutoML
- **MLOps**: MLflow, Docker, Docker Compose
- **Development**: Poetry, Jupyter, Pytest

## Setup and Usage

### 1. Prerequisites
- Docker and Docker Compose
- Git

### 2. Initial Setup
1.  **Clone the repository:**
    ```bash
    git clone [https://github.com/your-username/fraud-guardian-ml.git](https://github.com/your-username/fraud-guardian-ml.git)
    cd fraud-guardian-ml
    ```
2.  **Create `.env` file:**
    Copy the example environment file. The default values are fine for local development.
    ```bash
    cp .env.example .env
    ```
3.  **Build and run containers:**
    This will start the development container, PostgreSQL, and MLflow.
    ```bash
    docker-compose up -d --build
    ```

### 3. Development Environment
It is highly recommended to use the **VSCode Dev Containers** extension.
1.  Open the project folder in VSCode.
2.  When prompted, click "Reopen in Container".

### 4. Feature Generation
To generate the raw data and create the feature table for model training, run the following command from your host machine's terminal:
```bash
docker-compose exec dev poetry run python src/scripts/create_features.py
```

This script executes the entire feature engineering pipeline. It reads the raw data, calculates all features (Recency, Frequency, Monetary, etc.), and creates the final `feature_transactions` table.

### 5\. Verify Data

You can verify that the feature table has been created with the following command:

```bash
docker-compose exec db psql -U user -d fraud_detection -c "SELECT COUNT(*) FROM feature_transactions;"
```

## Development Progress

  - ✅ **Sprint 1: Infrastructure setup & EDA - COMPLETE**
  - ✅ **Sprint 2: Feature engineering & Pipeline - COMPLETE**
  - Sprint 3: Machine learning model comparison
  - Sprint 4: API development & integration

## License

MIT License - See LICENSE file for details

## Author

Hikaru Tomizawa (富澤晃)

-----

*This project is developed for learning and portfolio purposes.*